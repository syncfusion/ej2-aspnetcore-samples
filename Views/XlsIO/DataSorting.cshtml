@using Syncfusion.EJ2


@section ActionDescription{
    This sample demonstrates how to sort data in spreadsheet using XlsIO.
}
@section Meta{
    <meta name="description" content="This sample demonstrates how to create Excel file with data sorting in ASP.NET Core using Syncfusion XlsIO (Excel) library." />
}
@section Description{
    Essential XlsIO can sort a range of cells dynamically, at runtime without any dependency on MS Excel. It sorts the data based on values and colors.
    <br />
    <br /><b>Features:</b>
    <br />
    <br />
    <ul>
        <li>Supports to sort the large data</li>
        <li>Sorts based on the selected algorithm</li>
        <li>Sorts the data based on the cell and font color</li>
    </ul>
}
@section ControlsSection
{
    <div class="control-section">
        @{Html.BeginForm("DataSorting", "XlsIO", FormMethod.Post);
        <div class="rowdiv">
            <p>
                Click the button to view an Excel spreadsheet generated by Essential XlsIO. Please
                note that Microsoft Excel Viewer or Microsoft Excel is required to view the resultant document.
            </p>
        </div>
        <br />
        <div class="rowdiv">
            <table id="PanelTable" width="450px">
                <tr>
                    <td style="font-weight: normal">
                        Sort On Values
                    </td>
                </tr>
                <tr>
                    <td>
                        <br />
                        Choose the column to sort:
                    </td>
                    <td></td>
                </tr>
                <tr>
                    <td>
                        <table>
                            <tr>
                                <td>
                                    <br />
                                    First Column:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                </td>
                                <td>
                                    <select name="FirstColumn" id="firstColumn" class="e-dropdown-popup">
                                        <option>ID</option>
                                        <option>Name</option>
                                        <option>Salary</option>
                                    </select>
                                </td>
                            </tr>
                        </table>
                    </td>
                    <td>
                        <div id="dAddSecondLevel">
                            <br />
                            <input type="checkbox" id="addSecondLevel" name="SecondLevel" value="SecondLevel" onchange="secondClick()" />
                            Add Level
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <table id="tblSecond">
                            <tr>
                                <td>
                                    <br />
                                    Second Column:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                </td>
                                <td>
                                    <select name="SecColumn" id="secColunn" class="e-dropdown-popup">
                                        <option>ID</option>
                                        <option>Name</option>
                                        <option>Salary</option>
                                    </select>
                                </td>
                            </tr>
                        </table>
                    </td>
                    <td>
                        <table id="tblCheckbox">
                            <tr>
                                <td>
                                    <br />
                                    <input type="checkbox" id="addThirdLevel" name="ThirdLevel" value="ThirdLevel" onchange="thirdClick()" />
                                    Add Level
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td>
                        <table id="tblThird">
                            <tr>
                                <td>
                                    <br />
                                    Third Column:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                </td>
                                <td>
                                    <select name="ThirdColumn" id="third" class="e-dropdown-popup">
                                        <option>ID</option>
                                        <option>Name</option>
                                        <option>Salary</option>
                                    </select>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td>
                        <br />
                        Order By
                    </td>
                </tr>
                <tr>
                    <td>
                        <table id="tblButton" width="150px" border="0">
                            <tr>
                                <td>
                                    <table width="150px" border="0">
                                        <tr>
                                            <td>
                                                <table>
                                                    <tr>
                                                        <td>
                                                            @Html.EJS().RadioButton("radio1").Label("Ascending").Name("SortBy").Value("Ascending").Checked(true).Render()
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                        <tr><td><br /></td></tr>
                                        <tr>
                                            <td>
                                                <table>
                                                    <tr>
                                                        <td>
                                                            @Html.EJS().RadioButton("radio2").Label("Descending").Name("SortBy").Value("Descending").Checked(false).Render()
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </table>
                    </td>
                    <td>
                        <input id="sortvalues" type="submit" name="SortData" value="Sort Values" class="e-btn" height="100"/>
                    </td>
                </tr>
                <tr>
                    <td></td>
                    <td>
                        <input id="viewtemplate" type="submit" name="view" value="View Input Template"  class="e-btn" height="100"/>
                    </td>
                </tr>
            </table>
        </div>
        <script type="text/javascript">
            function ready() {
                document.getElementById("tblSecond").hidden = true;
                document.getElementById("tblThird").hidden = true;
                document.getElementById("tblCheckbox").hidden = true;
                document.getElementById("pOnTop").hidden = true;
                document.getElementById("pOnBottom").hidden = true;
            }
            window.onload = ready;
        </script>
        <script type="text/javascript">
            function change() {

                var other = document.getElementById("cmbSortOn").val();
                if (other == "Values") {
                    document.getElementById("pOnTop").hidden = true;
                    document.getElementById("pOnBottom").hidden = true;
                    document.getElementById("pAscending").hidden = false;
                    document.getElementById("pDescending").hidden = false;
                    document.getElementById("dAddSecondLevel").hidden = false;
                    document.getElementById("firstColumn").val("ID");
                }
                else {
                    document.getElementById("firstColumn").val("City");
                    document.getElementById("pOnTop").hidden = false;
                    document.getElementById("pOnBottom").hidden = false;
                    document.getElementById("pAscending").hidden = true;
                    document.getElementById("pDescending").hidden = true;
                    document.getElementById("dAddSecondLevel").hidden = true;
                }
            }
            function secondClick() {

                var other = document.getElementById("addSecondLevel").checked;
                if (other == false) {
                    document.getElementById("tblSecond").hidden = true;
                    document.getElementById("tblCheckbox").hidden = true;
                    document.getElementById("tblThird").hidden = true;
                }
                else {
                    document.getElementById("tblSecond").hidden = false;
                    document.getElementById("tblCheckbox").hidden = false;
                }
            }

            function thirdClick() {
                var other = document.getElementById("addThirdLevel").checked;
                if (other == false) {
                    document.getElementById("tblThird").hidden = true;
                }
                else {
                    document.getElementById("tblThird").hidden = false;
                }
            }
        </script>
        }
    </div>
}
