@page
@model EJ2CoreSampleBrowser.Pages.ChatUI.DefaultFunctionalitiesModel
@using Syncfusion.EJ2

@section ControlsSection {
    <div class="control-section chat-ui">
        <div class="default-chatui">
            <ejs-chatui id="chatUser1" headerText="Albert" headerIconCss="chat_user1_avatar" userTyping="userOneTyping" messageSend="messageSendOne" created="userOneCreated">
                <e-chatui-headertoolbar items="@Model.HeaderToolbar1"></e-chatui-headertoolbar>
                <e-chatui-messages>
                    @foreach (var message in Model.ChatMessagesData)
                    {
                        <e-chatui-message text="@message.Text" author="@message.Author"></e-chatui-message>
                    }
                </e-chatui-messages>
                <e-chatui-user id="user2" user="Reena" avatarUrl="./../css/chatui/images/reena.png"></e-chatui-user>
            </ejs-chatui>
            <ejs-chatui id="chatUser2" headerText="Reena" headerIconCss="chat_user2_avatar" suggestions="@Model.DefaultChatSuggestions" userTyping="userTwoTyping" messageSend="messageSendTwo" created="userTwoCreated">
                <e-chatui-headertoolbar items="@Model.HeaderToolbar2"></e-chatui-headertoolbar>
                <e-chatui-messages>
                    @foreach (var message in Model.ChatMessagesData)
                    {
                        <e-chatui-message text="@message.Text" author="@message.Author"></e-chatui-message>
                    }
                </e-chatui-messages>
                <e-chatui-user id="user1" user="Albert" avatarUrl="./../css/chatui/images/andrew.png"></e-chatui-user>
            </ejs-chatui>
        </div>
    </div>
}

@section PreScripts {
    <script>
        var defaultChatUIObj1;
        var defaultChatUIObj2;
        function userOneCreated() {
            defaultChatUIObj1 = ej.base.getInstance(document.getElementById('chatUser1'), ejs.interactivechat.ChatUI);
            var dropdownObj = new ej.splitbuttons.DropDownButton({
                items: [
                    { text: 'Mute', iconCss: 'e-icons e-eye-slash' },
                    { separator: true },
                    { text: 'Delete', iconCss: 'e-icons e-trash' }
                ],
                iconCss: 'e-icons e-more-horizontal-1',
                cssClass: 'e-caret-hide',
                select: (args) => {
                    if (['Mute', 'Unmute'].includes(args.item.text)) {
                        args.item.text = args.item.text === 'Mute' ? 'Unmute' : 'Mute';
                    }
                    if (args.item.text === 'Delete') {
                        defaultChatUIObj1.messages = [];
                    }
                }
            }, '#dduser1Menu');
        }

        function userTwoCreated() {
            defaultChatUIObj2 = ej.base.getInstance(document.getElementById('chatUser2'), ejs.interactivechat.ChatUI);
            var dropdownObj = new ej.splitbuttons.DropDownButton({
                items: [
                    { text: 'Mute', iconCss: 'e-icons e-eye-slash' },
                    { separator: true },
                    { text: 'Delete', iconCss: 'e-icons e-trash' }
                ],
                iconCss: 'e-icons e-more-horizontal-1',
                cssClass: 'e-caret-hide',
                select: (args) => {
                    if (['Mute', 'Unmute'].includes(args.item.text)) {
                        args.item.text = args.item.text === 'Mute' ? 'Unmute' : 'Mute';
                    }
                    if (args.item.text === 'Delete') {
                        defaultChatUIObj2.messages = [];
                    }
                }
            }, '#dduser2Menu');
        }

        function messageSendOne(args) {
            defaultChatUIObj1.suggestions = [];
            defaultChatUIObj2.addMessage(args.message);
        }

        function messageSendTwo(args) {
            defaultChatUIObj2.suggestions = [];
            defaultChatUIObj1.addMessage(args.message);
        }

        function userOneTyping(args) {
            handleUserTyping(args, defaultChatUIObj2);
        }

        function userTwoTyping(args) {
            handleUserTyping(args, defaultChatUIObj1);
        }

        function handleUserTyping(args, otherChatUser) {
            if (!args.isTyping) {
                otherChatUser.typingUsers = otherChatUser.typingUsers.filter(userItem => userItem.user !== args.user.user);
            } else {
                if (!otherChatUser.typingUsers.some(userItem => userItem.user === args.user.user)) {
                    otherChatUser.typingUsers = [...otherChatUser.typingUsers, args.user];
                }
            }
        }
    </script>
}

<style>
    .default-chatui {
        height: 500px;
        width: 65%;
        margin: 0 auto;
        display: flex;
        flex-direction: row;
        gap: 50px;
    }

    .default-chatui .chat_user1_avatar {
        background-image: url('./../css/chatui/images/andrew.png');
        background-color: unset;
    }

    .default-chatui .chat_user2_avatar {
        background-image: url('./../css/chatui/images/reena.png');
        background-color: unset;
    }    

    @@media only screen and (max-width: 850px) {
        .default-chatui {
            flex-direction: column;
            height: 500px;
            width: 80%;
        }
        .chat-ui.control-section {
            height: 1050px;
        }
    }
</style>

@section Meta {
    <meta name="description" content="This example demonstrates the DefaultFunctionalities in ASP.NET Core Chat UI control. Explore here for more details." />
}

@section ActionDescription {
    <div id="action-description">
        <p>This sample demonstrates the features of the Chat UI control, designed to simulate a real-time chat interface. It highlights customizable elements like headers, avatars, synchronized messaging update, and real-time typing indicators.</p>
    </div>
}

@section Description {
    <div id="description">
        <p>
            In this example, two Chat UI web controls are used to represent users <b>Albert</b> and <b>Reena</b>, each with a unique header, avatar, and toolbar. Messages are instantly synchronized between the two users through the <a target="_blank" href="https://help.syncfusion.com/cr/aspnetcore-js2/Syncfusion.EJ2.InteractiveChat.ChatUI.html#Syncfusion_EJ2_InteractiveChat_ChatUI_MessageSend">messageSend</a> event, while typing indicators are shown in the other chat interface via the <a target="_blank" href="https://help.syncfusion.com/cr/aspnetcore-js2/Syncfusion.EJ2.InteractiveChat.ChatUI.html#Syncfusion_EJ2_InteractiveChat_ChatUI_UserTyping">userTyping</a> event, adding a more interactive feel.
            The toolbar for each chat includes a dropdown menu with options like muting and deleting messages, demonstrating the component’s ability to customize and control the chat experience.
        </p>
    </div>
}