﻿@using Syncfusion.EJ2.Diagrams;
@using EJ2CoreSampleBrowser.Controllers.Diagram;

@section ControlsSection{

    <div class="control-section">
        <div id="umlActivityDiagram" style="width: 100%; height: 521px">
            <div class="sb-mobile-palette-bar">
                <div id="palette-icon" style="float: right;" role="button" class="e-ddb-icons1 e-toggle-palette"></div>
            </div>
            <div id="palette-space" class="sb-mobile-palette">
                <ejs-symbolpalette id="symbolPalette" getNodeDefaults="@ViewBag.getSymbolDefaults"
                                   symbolHeight="55" symbolWidth="55" expandMode="@ViewBag.Multiple"
                                   width="100%" height="100%" palettes="ViewBag.Palette"
                                   symbolMargin="new SymbolPaletteMargin() { Left=10,Right=10,Top=10,Bottom=10}"
                                   getSymbolInfo="@ViewBag.getSymbolInfo">
                </ejs-symbolpalette>
            </div>
            <div id="diagram-space" class="sb-mobile-diagram">
                <ejs-diagram id="container" width="100%" height="100%"
                             created="diagramCreated" getNodeDefaults="@ViewBag.getNodeDefaults"
                             getConnectorDefaults="@ViewBag.getConnectorDefaults" nodes="ViewBag.nodes"
                             connectors="ViewBag.connectors">
                    <e-diagram-snapsettings constraints="None"></e-diagram-snapsettings>
                </ejs-diagram>
            </div>
        </div>
    </div>
    <style>

        #diagram {
            display: block;
        }

        #symbolPalette {
            display: block;
        }

        .container-fluid {
            padding-bottom: 15px;
        }
        .sb-mobile-palette {
            width: 210px;
            height: 100%;
            float: left;
        }

        .sb-mobile-palette-bar {
            display: none;
        }

        .sb-mobile-diagram {
            width: calc(100% - 212px);
            height: 100%;
            float: left;
            border: 1px solid rgba(0, 0, 0, 0.12);
            border-left: none;
        }

        .container-fluid {
            padding-bottom: 15px;
        }

        @@media (max-width: 550px) {

            .sb-mobile-palette {
                z-index: 19;
                position: absolute;
                display: none;
                transition: transform 300ms linear, visibility 0s linear 300ms;
                width: 39%;
                height: 100%;
            }

            .sb-mobile-palette-bar {
                display: block;
                width: 100%;
                background: #fafafa;
                padding: 10px 10px;
                border: 0.5px solid #e0e0e0;
                min-height: 40px;
            }

            .sb-mobile-diagram {
                width: 100%;
                height: 100%;
                float: left;
                left: 0px;
            }

            #palette-icon {
                font-size: 20px;
            }
        }

        .sb-mobile-palette-open {
            position: absolute;
            display: block;
            right: 15px;
        }

        @@font-face {
            font-family: 'e-ddb-icons1';
            src: url(data:application/x-font-ttf;charset=utf-8;base64,AAEAAAAKAIAAAwAgT1MvMj1tSfIAAAEoAAAAVmNtYXDnEOdVAAABiAAAADZnbHlmdC1P4gAAAcgAAAAwaGVhZBJhohMAAADQAAAANmhoZWEIVQQDAAAArAAAACRobXR4CAAAAAAAAYAAAAAIbG9jYQAYAAAAAAHAAAAABm1heHABDgAUAAABCAAAACBuYW1lm+wy9gAAAfgAAAK1cG9zdLnsYngAAASwAAAAMAABAAAEAAAAAFwEAAAAAAAD+AABAAAAAAAAAAAAAAAAAAAAAgABAAAAAQAAgNcenF8PPPUACwQAAAAAANelrs4AAAAA16WuzgAAAAAD+AN6AAAACAACAAAAAAAAAAEAAAACAAgAAgAAAAAAAgAAAAoACgAAAP8AAAAAAAAAAQQAAZAABQAAAokCzAAAAI8CiQLMAAAB6wAyAQgAAAIABQMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUGZFZABA5wDnAAQAAAAAXAQAAAAAAAABAAAAAAAABAAAAAQAAAAAAAACAAAAAwAAABQAAwABAAAAFAAEACIAAAAEAAQAAQAA5wD//wAA5wD//wAAAAEABAAAAAEAAAAAAAAAGAAAAAIAAAAAA/gDegACAAcAACUhCQEhATUhAQQC9P6G/YoBMQFF/YqGAjf+hgH0QwAAAAAAEgDeAAEAAAAAAAAAAQAAAAEAAAAAAAEAEwABAAEAAAAAAAIABwAUAAEAAAAAAAMAEwAbAAEAAAAAAAQAEwAuAAEAAAAAAAUACwBBAAEAAAAAAAYAEwBMAAEAAAAAAAoALABfAAEAAAAAAAsAEgCLAAMAAQQJAAAAAgCdAAMAAQQJAAEAJgCfAAMAAQQJAAIADgDFAAMAAQQJAAMAJgDTAAMAAQQJAAQAJgD5AAMAAQQJAAUAFgEfAAMAAQQJAAYAJgE1AAMAAQQJAAoAWAFbAAMAAQQJAAsAJAGzIERpYWdyYW1fU2hhcGVzX0ZPTlRSZWd1bGFyRGlhZ3JhbV9TaGFwZXNfRk9OVERpYWdyYW1fU2hhcGVzX0ZPTlRWZXJzaW9uIDEuMERpYWdyYW1fU2hhcGVzX0ZPTlRGb250IGdlbmVyYXRlZCB1c2luZyBTeW5jZnVzaW9uIE1ldHJvIFN0dWRpb3d3dy5zeW5jZnVzaW9uLmNvbQAgAEQAaQBhAGcAcgBhAG0AXwBTAGgAYQBwAGUAcwBfAEYATwBOAFQAUgBlAGcAdQBsAGEAcgBEAGkAYQBnAHIAYQBtAF8AUwBoAGEAcABlAHMAXwBGAE8ATgBUAEQAaQBhAGcAcgBhAG0AXwBTAGgAYQBwAGUAcwBfAEYATwBOAFQAVgBlAHIAcwBpAG8AbgAgADEALgAwAEQAaQBhAGcAcgBhAG0AXwBTAGgAYQBwAGUAcwBfAEYATwBOAFQARgBvAG4AdAAgAGcAZQBuAGUAcgBhAHQAZQBkACAAdQBzAGkAbgBnACAAUwB5AG4AYwBmAHUAcwBpAG8AbgAgAE0AZQB0AHIAbwAgAFMAdAB1AGQAaQBvAHcAdwB3AC4AcwB5AG4AYwBmAHUAcwBpAG8AbgAuAGMAbwBtAAAAAAIAAAAAAAAACgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgECAQMABlNoYXBlcwAA) format('truetype');
            font-weight: normal;
            font-style: normal;
        }


        .e-ddb-icons1 {
            font-family: 'e-ddb-icons1';
            speak: none;
            font-size: 16px;
            font-style: normal;
            font-weight: normal;
            font-variant: normal;
            text-transform: none;
            line-height: 1;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .e-toggle-palette::before {
            content: "\e700"
        }
        .material #umlActivityDiagram #palette-space .e-accordion {
            border: none;
        }

        .material #umlActivityDiagram #palette-space {
            border: 1px solid rgba(0, 0, 0, 0.12);
        }

        .bootstrap #umlActivityDiagram .sb-mobile-diagram {
            height: calc(100% - 17px);
            margin-top: 5px;
            border-radius: 4px;
            border-left: 1px solid rgba(0, 0, 0, 0.12);
        }

        .fabric #umlActivityDiagram .sb-mobile-diagram {
            border-left: 1px solid rgba(0, 0, 0, 0.12);
        }
    </style>
    <script>

        function getNodeDefaults(obj, diagram) {
            obj.ports = getPorts(obj);
            if (obj.ports) {
                for (var i = 0; i < obj.ports.length; i++) {
                    obj.ports[i].visibility = ej.diagrams.PortVisibility.Hidden;
                }
            }
            if (obj.id === 'Start' || obj.id === 'node2' || obj.id === 'node9' || obj.id === 'node11') {
                obj.style.fill = '#444';
            }
            obj.style.strokeColor = '#444';
            return obj;
        }

        function getConnectorDefaults(obj, diagram) {
            if (obj.id.indexOf('connector') !== -1) {
                obj.type = 'Orthogonal'; obj.cornerRadius = 10;
                obj.targetDecorator = { shape: 'OpenArrow', style: { strokeColor: '#444', fill: '#444' } };
            }
        }

        function getPorts(obj) {
            if (obj.id === 'node2' || obj.id === 'node9') {
                var node2Ports = [
                    { id: 'port1', offset: { x: 0.2, y: 1 } },
                    { id: 'port2', offset: { x: 0.8, y: 1 } },
                    { id: 'port3', offset: { x: 0.2, y: 0 } },
                    { id: 'port4', offset: { x: 0.8, y: 0 } },
                ];
                return node2Ports;
            } else {
                var ports = [
                    { id: 'portLeft', offset: { x: 0, y: 0.5 } },
                    { id: 'portRight', offset: { x: 1, y: 0.5 } },
                    { id: 'portBottom', offset: { x: 0.5, y: 1 } },
                    { id: 'portTop', offset: { x: 0.5, y: 0 } },
                ];
                return ports;
            }
        }

        function getSymbolDefaults(symbol, diagram) {
            if (symbol.id === 'JoinNode') {
                symbol.width = 20; symbol.height = 70;
            } else if (symbol.id === 'ForkNode') {
                symbol.width = 70; symbol.height = 20;
            } else if (symbol.id === 'Decision' || symbol.id === 'MergeNode') {
                symbol.width = 70; symbol.height = 40;
            } else {
                symbol.width = 70; symbol.height = 70;
            }
            if (symbol.id === 'InitialNode' || symbol.id === 'FinalNode' || symbol.id === 'JoinNode' || symbol.id === 'ForkNode') {
                symbol.style.fill = '#444';
            }
            symbol.style.strokeColor = '#444';
        }

        function getSymbolInfo(symbol) {
            return { fit: true };
        }

        function diagramCreated() {
            addEvents();
        }

        function addEvents() {
            var isMobile = window.matchMedia('(max-width:550px)').matches;
            if (isMobile) {
                var paletteIcon = document.getElementById('palette-icon');
                if (paletteIcon) {
                    paletteIcon.addEventListener('click', openPalette, false);
                }
            }
        }

        function openPalette() {
            var paletteSpace = document.getElementById('palette-space');
            var isMobile = window.matchMedia('(max-width:550px)').matches;
            if (isMobile) {
                if (!paletteSpace.classList.contains('sb-mobile-palette-open')) {
                    paletteSpace.classList.add('sb-mobile-palette-open');
                }
                else {
                    paletteSpace.classList.remove('sb-mobile-palette-open');
                }
            }
        }
    </script>

}
@section ActionDescription{
    <p>
        This sample represents the message flow from one activity to another in customer service using built-in UML activity shapes.
    </p>

}
@section Meta{
    <meta name="description" content="This sample represents the message flow from one activity to another in customer service using built-in UML activity shapes." />

}
@section Description{
    <p>
        This example shows how to create activity shapes using diagram <code>UMLActivity</code> shapes. The <code>type</code> property of the
        <code>shape</code> can be used to create <code>UMLActivity</code> nodes. The <code>shape</code> property of the shape allows you to create UML
        activity shapes.
    </p>
}
